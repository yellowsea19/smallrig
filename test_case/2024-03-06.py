import pandas as pd
import pymysql
import unittest
from datetime import datetime
import pymongo
from pymongo import MongoClient
import json
from bson import ObjectId
from tmp import pull_order

class TestMongoDB(unittest.TestCase):
    def setUp(self):
        # self.client = MongoClient("mongodb://192.168.133.235:27017/?directConnection=true")
        # self.client = MongoClient("mongodb://smallrig:smallrig@192.168.133.233:27017/?authMechanism=DEFAULT&authSource=admin")
        self.client = MongoClient("mongodb://smallrig:smallrig@192.168.133.223:27017/?authMechanism=SCRAM-SHA-1&authSource=smallrig&directConnection=true")
        # self.client = MongoClient("mongodb://smallrig:smallrig@192.168.133.210:27017/?authMechanism=DEFAULT")
        self.db = self.client['smallrig']  # use your database name here
        self.allegro = {"BOUGHT":"已购买未结账","FILLED_IN":"填写了结账信息未付款","READY_FOR_PROCESSING":"付款完成","CANCELLED":"买家取消"}
        self.ebay = {"ACTIVE":"购买未付款","CANCELLED":"取消","COMPLETED":"支付完成","INACTIVE":"不活跃订单","CANCELPENDING":"正在取消","INPROCESS":"处理中"}
        self.shopee = {"UNPAID":"未支付","READY_TO_SHIP":"准备发货","PROCESSED":"打包完成准备发货","SHIPPED":"已发货","COMPLETED":"订单已经完成","IN_CANCEL":"订单正在取消","CANCELLED":"已取消","INVOICE_PENDING":"发票生成中","TO_CONFIRM_RECEIVE":"等待确认签收","TO_RETURN":"TO_RETURN"}
        self.lazada = {"unpaid":"未支付","pending":"待处理","canceled":"已取消","ready_to_ship":"准备发货","delivered":"已送达","returned":"已退回","shipped ":"已发货","failed":"失败","topack":"待打包","toship":"待发货","shipping and lost":"运输中遗失",}
        self.aliexpress = {"WAIT_SELLER_SEND_GOODS":"等待发货","SELLER_PART_SEND_GOODS":"部分发货","WAIT_BUYER_ACCEPT_GOODS": "等待买家收货","FUND_PROCESSING": "买卖家达成一致，资金处理中","PLACE_ORDER_SUCCESS": "等待买家付款","IN_CANCEL": "买家申请取消","IN_ISSUE": "含纠纷中的订单","IN_FROZEN": "冻结中的订单","WAIT_SELLER_EXAMINE_MONEY": "等待您确认金额","RISK_CONTROL": "订单处于风控24小时中，从买家在线支付完成后开始，持续24小时。","FINISH": "订单已关闭结束。包含取消订单、正常交易成功等情况","ARCHIVE": "交易归档"}
        self.douyin = {1: "待确认/待支付（订单创建完毕）", 105: "已支付", 2: "备货中", 101: "部分发货", 3: "已发货（全部发货）", 4: "已取消", 5: "已完成（已收货）"}
        self.wechat = {10: "待付款", 20: "待发货", 21: "部分发货", 30: "待收货", 100: "完成", 200: "全部商品售后之后，订单取消", 250: "未付款用户主动取消或超时未付款订单自动取消"}
        self.taobao = {"TRADE_NO_CREATE_PAY": "没有创建支付宝交易", "WAIT_BUYER_PAY": "等待买家付款", "WAIT_SELLER_SEND_GOODS": "等待卖家发货,即:买家已付款", "WAIT_BUYER_CONFIRM_GOODS": "等待买家确认收货,即:卖家已发货", "TRADE_BUYER_SIGNED": "买家已签收,货到付款专用", "TRADE_FINISHED": "交易成功", "TRADE_CLOSED": "付款以后用户退款成功，交易自动关闭", "TRADE_CLOSED_BY_TAOBAO": "付款以前，卖家或买家主动关闭交易", "PAY_PENDING": "国际信用卡支付付款确认中"}
        self.tmall = {"TRADE_NO_CREATE_PAY": "没有创建支付宝交易", "WAIT_BUYER_PAY": "等待买家付款", "WAIT_SELLER_SEND_GOODS": "等待卖家发货,即:买家已付款", "WAIT_BUYER_CONFIRM_GOODS": "等待买家确认收货,即:卖家已发货", "TRADE_BUYER_SIGNED": "买家已签收,货到付款专用", "TRADE_FINISHED": "交易成功", "TRADE_CLOSED": "付款以后用户退款成功，交易自动关闭", "TRADE_CLOSED_BY_TAOBAO": "付款以前，卖家或买家主动关闭交易", "PAY_PENDING": "国际信用卡支付付款确认中"}
        self.youzan =  {"WAIT_BUYER_PAY": "等待买家付款，定金预售描述：定金待付、等待尾款支付开始、尾款待付", "TRADE_PAID": "订单已支付", "WAIT_CONFIRM": "待确认，包含待成团、待接单等等。即：买家已付款，等待成团或等待接单", "WAIT_SELLER_SEND_GOODS": "等待卖家发货，即：买家已付款", "WAIT_BUYER_CONFIRM_GOODS": "等待买家确认收货，即：卖家已发货", "TRADE_SUCCESS": "买家已签收以及订单成功", "TRADE_CLOSED": "交易关闭"}
        self.leqimall =  {0: "待付款", 1: "待发货", 2: "部分发货", 3: "完全发货", 4: "确认收货", 5: "支付待确认"}
        self.ks = {0: "未知状态", 10: "待付款", 30: "已付款", 40: "已发货", 50: "已签收", 70: "订单成功", 80: "订单失败，订单整单取消会转为订单失败状态"}
        self.jdpop = {"WAIT_SELLER_STOCK_OUT": "等待出库", "WAIT_GOODS_RECEIVE_CONFIRM": "等待确认收货", "WAIT_SELLER_DELIVERY": "等待发货（只适用于海外购商家，含义为'等待境内发货'标签下的订单,非海外购商家无需使用）", "POP_ORDER_PAUSE": "POP暂停", "FINISHED_L": "完成", "TRADE_CANCELED": "取消", "LOCKED": "已锁定", "WAIT_SEND_CODE": "等待发货"}
        self.amazon = {"PendingAvailability": "预购商品,订单已下单，付款未获授权", "PENDING": "订单已下单，但付款未获授权", "UNSHIPPED": "付款已获授权，订单已准备好发货，但订单中的任何商品尚未发货", "PartiallyShipped": "订单中的一件或多件商品 [但不是全部] 已发货", "SHIPPED": "订单中的所有商品均已发货", "InvoiceUnconfirmed": "订单中的所有商品均已发货。卖家尚未向亚马逊确认发票已发送给买家", "CANCELED": "订单已取消", "Unfulfillable": "订单无法配送。此状态仅适用于多渠道配送订单。"}




    def query(self, sql):
        self.cursor.execute(sql)
        return self.cursor.fetchall()


    def test_connection(self):
        self.assertIsNotNone(self.db)



    def handle_objectid(self,data):
        """递归转换 MongoDB 数据，将所有 ObjectId 转化为字符串"""
        if isinstance(data, dict):
            for key, value in data.items():
                data[key] = self.handle_objectid(value)
        elif isinstance(data, list):
            for index, item in enumerate(data):
                data[index] = self.handle_objectid(item)
        elif isinstance(data, ObjectId):
            return str(data)
        return data


    def find(self,orderId="8182962096940031"):

        db_list = ["aliexpress_order_struct","allegro_order_struct","douyin_order_struct","jd_manual_order_struct","jd_pop_order_struct","kuaishou_order_struct","lazada_order_struct","leqimall_order_struct","pdd_order_struct","shopee_order_struct","taobao_order_struct","tmall_order_struct","wechat_order_struct","youzan_order_struct","ebay_order_struct","amazon_order_struct"]
        db_list = ["amazon_order_struct",]
        order_list = []
        for db in db_list:
            print( "-----------------------------------------" + db + "----------------------------------------------" + "\n")
            collection = self.db[db]  # use your collection name here
            results= collection.find({}).limit(2100).sort('insertTime',pymongo.DESCENDING) # get a single document
            for k in results:
                k = self.handle_objectid(k)
                print(json.dumps(k,ensure_ascii=False))
                # res = json.loads(k['order']['jdp_response'])
                # # print(res['trade_fullinfo_get_response']['trade']['orders']['order'])
                # for i in res['trade_fullinfo_get_response']['trade']['orders']['order']:
                #     print(json.dumps(i))
                #     print(json.dumps(i.get('store_code')))
                # for i in k['order']['jdp_response']['trade_fullinfo_get_response']['orders']['order']:
                #     print(i)
                # print(k['order']['productList'][0]['logisticsServiceName'])
                #速卖通
                # try:
                #     for warehouse in k['orderFee']['target']['childOrderList']:
                #         print(warehouse['logisticsWarehouseType'])
                #         print("代发")
                #         # print(json.dumps(warehouse))
                # except:
                #     print("自发")
                # print(json.dumps(k),'\n')
                # # print(k["order"]["status"])
    def test_find_all_day(self,orderId="8182962096940031"):

        db_list = ["amazon_order_struct"]
        for db in db_list:
            print( "-----------------------------------------" + db + "----------------------------------------------" + "\n")
            collection = self.db[db]
            query = { "insertTime": { "$gte": "2024-03-05 15:00:00" ,"$lte": "2024-03-05 23:59:59" } }
            results = collection.find(query).sort('insertTime', pymongo.DESCENDING)  # get a single document
            order_list = []
            for k in results:
                k = self.handle_objectid(k)
                print(k)
                # print(json.dumps(k, ensure_ascii=False))
                if k['orderId'] not in order_list:
                    order_list.append(k['orderId'])
            print("total: "+str(len(order_list)))
            print(order_list)





    def tearDown(self):
        self.client.close()

if __name__ == "__main__":
    unittest.main()


#0306版本  全量补偿订单脚本
pro_text = ['240306031505225814', '240301174021467744', '240306025320000715', '240306025250210459', '240306024357516432', '240306020646464640', '240306023937889041', '240306023949864661', '240306023844213509', '240306021036945899', '240306020805408682', '240306012744364870', '240306015525850786', '240306015433469507', '240306015351396559', '240305034644264913', '240304071734801195', '240305184915134866', '240306014849763278', '240306010309346319', '240306013416747986', '240306013435216654', '240306013228872876', '240306013102102396', '240306013014409297', '240306012101499440', '240306012120223653', '240306011225006050', '240306003337706298', '240306010227106998', '240306005510861384', '240306005408210413', '240306005505004170', '240306004625934317', '240306000807898282', '240306000611474038', '240306002849682811', '240306002118500738', '240306001645461528', '240306001324621297', '240305080602853560', '240305080449877074', '240305074108726163', '240305060624787563', '240305043824963379', '240305032138112691', '240305025546612073', '240305021311491720', '240305021037425645', '240305015940947028', '240305013415587142', '240305011015679485', '240305002247765428', '240305001014460088', '240304230538966454', '240304225444583470', '240304200910258413', '240304214455290316', '240304212209827665', '240304205832451886', '240304205059059233', '240304200004916484', '240304194816423115', '240304183252176604', '240304174520197010', '240304171832025556', '240304164347799153', '240304155111551768', '240303015913724597', '240213041854610705', '240217103153387028', '240216214235443458', '240216193558920827', '240216164512014045', '240216144713241742', '240216150656888490', '240216144151114139', '240216121026688951', '240216115254475198', '240214210759072519', '240214173217457870', '240214143911820662', '240214131433268701', '240214113145038257', '240213192118681644', '240213144659102221', '240213132033171775', '240212173341085831', '240211222359086819', '240211202831000533', '240211201619756240', '240211173343685948', '240211171306202321', '240211162824159904', '240211140238274870', '240211130619431371', '240211113342770387', '240211000644488837', '240210215403888112', '240210201936354046', '240210182541195394', '240210151120633180', '240209114909159109', '240208180249750150', '240208180538024373', '240208145141350595', '240208122710257455', '240208085859527790', '240207210807904960', '240207181004639684', '240207180128512370', '240206120943222897', '240205124816085558', '240204103339529630', '240219085611628089', '240219093357984483', '240218055908039003', '240218012603224090', '240217221051758723', '240217205546150011', '240217204507749256', '240217201507374516', '240217193017271853', '240217180527354275', '240217163342766104', '240217141806266569', '240217132400578783', '240217110501115488', '240217104747022632', '240217080039154862', '240217061155088461', '240217055139244379', '240217051519512051', '240217045758759296', '240217041656505647', '240217041504465426', '240217035113671223', '240217033024155510', '240217025609396029', '240217014656575078', '240217014628732441', '240217013945296565', '240216233450941172', '240216233332202749', '240216221705361290', '240216212928579620', '240216204230393247', '240216202135971136', '240216200610049535', '240216200026781268', '240216194355484988', '240216192524812923', '240216191532193783', '240216185058828037', '240216172752732114', '240216042851418364', '240216145057943868', '240216121349532392', '240216071514628526', '240216070614019346', '240216061257588725', '240216024727598609', '240216002743669648', '240216000216832321', '240215215052735106', '240215202415481945', '240215194259654211', '240215152057711254', '240215144332577281', '240215092352641629', '240215092503381402', '240215090338188787', '240215080327475728', '240215055824181793', '240215052539433927', '240215030106496661', '240214230335600777', '240214215053743439', '240214205457430802', '240214173357137450', '240214155857531215', '240214113039777875', '240214060709352730', '240214043203738281', '240214024958424069', '240213232018796020', '240213233304479707', '240213230031623186', '240213190042581423', '240213184554844218', '240213160131842416', '240213154756814931', '240213131500112238', '240213091632906856', '240213061806105329', '240213032827238047', '240213023312276505', '240213011008366927', '240213005454055026', '240213001501467903', '240212234745742019', '240212220010121970', '240212213724813764', '240212211202044478', '240212210658410446', '240212173917142222', '240212173216143938', '240212155435779003', '240212140529863987', '240212085119001545', '240212074942991475', '240212071647306414', '240212065006106829', '240212060030547984', '240212023543448920', '240211185836502462', '240211185119874972', '240211173340184389', '240211172348152387', '240211161250240651', '240211002756053820', '240211002030999175', '240210151226925611', '240210124836646621', '240210094024971151', '240210082227103376', '240210030033209741', '240210001209376659', '240209235026420942', '240209231052592652', '240209223355664238', '240209222014752574', '240209220153620393', '240209195658923746', '240209075025629941', '240209072247643241', '240209023417566931', '240208214440217037', '240208085453080333', '240208071956587928', '240208032721166854', '240207211651078730', '240207114901375476', '240207113422172592', '240207093716075987', '240207091741978440', '240206214226575354', '240206133935309527', '240205095317052325', '240125055550892202', '240111104013685975', '231127193923517996', '231127192302235719', '231127184934520369', '231127184829601694', '231127184201572514', '231127183205087175', '231127181128866978', '231127180501041302', '231123110430300368', '231123101851628233', '231122181538055185', '231122155047825545', '231122072303138532', '231122065357096752', '231122061838071960', '231122030610184644', '231122004912549411', '231122004900021051', '231121235423771621', '231121233756585400', '231121211522995406', '231121210010568831', '231121205825956829', '231121202032875559', '231121183625863966', '231121165207669097', '231121122735681462', '231121115641509873', '231121113104312730', '231121070620340775', '231121011712109290', '231120232329242222', '231120225353490972', '231120210241517007', '231120171629672400', '231120150816897113', '231120135202476890', '231120122136851361', '231120114853352469', '231120101206528746', '231120044739759318', '231117231758998387', '240215043853451018', '240214010244903828', '240213081241926060', '240213014006442024', '240211230547170172', '240210152254796670', '240208050426482880', '231121053211282699', '231120082704077306', '240217034742929327', '240216161126655598', '240215070551766613', '240212083414612727', '240209092214134543', '240208051430716205', '231122053441294612', '231121154729586852', '231120094342221359', '231211213857416181', '231208143539488357', '231208002717699427', '231207180408371864', '231206044053404817', '231206025154060010', '231205221453067455', '231205201628900598', '231205142313085579', '231203190038756281', '231203174042802160', '231203132512974376', '231128134809513972', '231128160251063454', '231127222902173034', '231127221610823299', '231127220439770922', '231127211226675139', '231127195632277251', '231127193752005209', '231127183327447665', '231122103223266678', '231122095409984769', '231122093932022195', '231122072701213848', '231121193748591603', '231121121347638278', '231120194606439609', '231120160929855309', '231120151302661241', '231120032617425151', '231120022341722703', '240218192240288662', '240217164556784352', '240214165759260784', '240214093503853731', '240213202351574492', '240211210533063141', '240211193726105133', '240211013244094530', '240210235746126524', '240210223527293759', '240210220935892207', '240210025704973379', '231219154429727805', '231213152639992355', '231209023841866932', '231209023531773693', '231208235124822627', '231208215036210318', '231208213209068589', '231208171818743194', '231208184343410764', '231208180538190616', '231208164855961062', '231208163624878873', '231208151221825229', '231208145230774190', '231208142232853516', '231208143041799680', '231208133640286282', '231208133608299983', '231208132148678757', '231208064442866244', '231208063315414523', '231208055936135534', '231208053220341117', '231208025749569728', '231208023132543501', '231208022039127540', '231208021839744752', '231207233551217679', '231207224751683671', '231207224535102735', '231207212730489742', '231207204220517578', '231207201403963188', '231207194521738730', '231207182722871386', '231207180315693751', '231207172530790131', '231207171343183121', '231207164534764362', '231207163742462927', '231206040146777889', '231206030437921774', '231205231803529169', '231205231945036096', '231205230537215203', '231205213117595759', '231205202931526516', '231205204447262627', '231205204325675476', '231205203235683259', '231205194424735791', '231205184248834374', '231205161122006768', '231205140647812804', '231205102036167689', '231204134546847909', '231204094825004983', '231204062757685023', '231204062337145946', '231204050405327746', '231204025046616755', '231204015658581596', '231203232440598274', '231203185148234628', '231203183804805664', '231203181734850109', '231203164224101216', '231203154607107210', '231203154159370701', '231203071839701197', '231203070502053978', '231129041200750222', '231129034807906779', '231128205106187760', '231128202617792057', '231128184928354704', '231128145458634932', '231128060320103954', '231128042110708319', '231128034347905067', '231128031448574893', '231128031052223487', '231128015549416265', '231128013655127309', '231128011610960532', '231128004006611240', '231128002741397771', '231128000909352968', '231128000146260974', '231127234323926183', '231127234421337475', '231127233137211380', '231127230316935335', '231127221556360273', '231127221805997127', '231127220122129361', '231127215613672665', '231127214947558658', '231127205017987023', '231127203115371129', '231127201926027333', '231127201240037439', '231127200517894460', '231207232248416994', '231205224822430755', '231203123453522113', '231203103937841575', '231128121808870100', '231212022642449578', '231209020600307038', '231208061023453340', '231208015312902885', '231207212125842511', '231206034239272255', '231206034546209777', '231205114729157429', '231204125526573631', '231204082614215247', '231204015821184542', '231203160116363750', '231203051853904708', '240305235059246046', '240305233709027030', '240305233643567438', '240305233203835333', '240305225311314931', '240305232215847107', '240305232000352572', '240305231309965464', '240305225506974562', '240305224151287273', '240305224039482336', '240208104018666643', '240222233006695026', '240305222813655367', '240305220809807550', '240305215709083894', '240305215811394141', '240305215534853445', '240305215425930359', '240305215243613629', '240305215123877002', '240305212507214662', '240305214233525910', '240305210041538451', '240305212412889748', '240305205219051359', '240305212403996870', '240305212235236091', '240305211850129940', '240305211934827723', '240305211656898627', '240305211421531510', '240305203914682729', '240305210247812784', '240305205222698355', '240229023433237025', '240305190952671347', '240305204403621417', '240305203108511056', '240305202552125165', '240305202923511673', '240305201544066239', '240305201146170756', '240305200253913558', '240305200024745423', '240305195004485512', '240305194642549569', '240305194219592541', '240305190938205213', '240305194212061896', '240305193544880924', '240305193839752233', '240305193649515450', '240305191902493867', '240305192621406973', '240305192738360819', '240305192831820853', '240305192453702721', '240305192400339438', '240305192039631428', '240305192106203905', '240305191936741306', '240305191552157197', '240305191202903672', '240305190703593177', '240305190154045384', '240305185456795651', '240305181937802759', '240305184949381447', '240305184921789074', '240305173031036811', '240305184636554973', '240305184404040113', '240305183537230838', '240305181228355398', '240305174957147539', '240305182350247469', '240305181920729078', '240305181845025876', '240305181446789178', '240305180918481839', '240305180838858768', '240305172515432791', '240305175117136048', '240305175101717371', '240305173727486056', '240305173238616390', '240305173104744277', '240305172323533106', '240305172805600609', '240305172528326911', '240305170218233792', '240305172107319726', '240305164114962403', '240305163242835631', '240305165857804974', '240228111153072998', '240305163749926301', '240305163057711715', '240305162709436341', '240305162721835320', '240305161955044170', '240305160547837989', '240305160615565962', '240305160726327306', '240223150218181181', '240226222303006128', '240304211206099241', '240304211102047462', '240304203446878025', '240304203401857311', '240304195857498842', '240304195342644104', '240304181628745974', '240304174607864274', '240304172911678485', '240304171427220576', '240304162909123535', '240304152133639489', '240304145809629543', '240304135619894612', '240304132650033738', '240304121925360946', '240304114240828573', '240304112142154750', '240304111059651477', '240303201911215837', '240302162144858449', '240227201727687054', '240305144815892537', '240305021406902603', '240304224549796626', '240304220202656727', '240304192017186884', '240303165335906317', '240304144342117272', '240304143137899401', '240304103803949813', '240304101256854480', '240304084308446592', '240304085652749194', '240304052326635801', '240303172224844878', '240301175116841034', '240224125847473112', '240305153750630482', '240305153552713661', '240305152714036523', '240305152355728076', '240305151709938842', '240305152506235902', '240305152306844643', '240305151750198282', '240305151142825911', '240305150628900928', '240305150441663137', '240305150159342270', '240229172610729699', '240305141223803306', '240305144459254233', '240228202310077983', '240305143658014273', '240305143536063109', '240305135259633881', '240228214407945473', '240305143024351547', '240305135446640333', '240305135410781850', '240305134850788177', '240305142127301846', '240305141508196057', '240210144738112434', '240305140017881990', '240305140300852855', '240305140117801682', '240305134956275391', '240305135605128238', '240305133454187559', '240305133535303297', '240305133342858884', '240305132446545590', '240305131845870773', '240303172927938063', '240305130751446853', '240305130514395957', '240305125653964005', '240305120823171968', '240305125300702524', '230829075444179422', '240305125015402369', '240305061546878138', '240305123009064118', '240305123211375329', '240305122628581182', '240305122359622349', '240305122742924921', '240305115504056598', '240305114307605510', '240305120609343685', '240305113222572745', '240305120420254052', '240305115916029307', '240212070701407030', '240212063707620256', '240212035119616311', '240212022113409930', '240212012239166740', '240212011248292368', '240212011314144457', '240212004834512458', '240211232732061125', '240211215649706138', '240211180926096909', '240211175227312989', '240211173058569988', '240211155049457017', '240211155318922042', '240211135306895117', '240211090515729048', '240211083257449132', '240211063651053893', '240211053628311760', '240211052528588778', '240211045303349087', '240211040653393487', '240211030123970377', '240211024746714535', '240210210853842533', '240210185911685111', '240210185719801851', '240210171211613806', '240210164551022392', '240210164232333713', '240210162729144435', '240210142521741080', '240210072924624999', '240210062405428755', '240210053042151500', '240210043328639577', '240210040101569702', '240210033430865370', '240210030743299798', '240209144543354368', '240209143837193106', '240209142451719726', '240208135833001536', '240208122434618293', '240305114401126693', '240305114938068068', '240305114553590706', '240305114605829923', '240305113153908715', '240305111354547514', '240305110857908420', '240305110234923413', '240304214305211476', '240304194018413597', '240304174000849371', '240304173520643811', '240304160900573543', '240304155159789078', '240304151343483277', '240304142300114546', '240304132329515165', '240304092647458915', '240303152843734078', '240302144551247386', '240302141252938681', '240301221922581217', '240227175947560999', '240303143315013133', '240301094909468730', '240305102336765750', '240305032101301129', '240305024244431130', '240305023034219103', '240305020421386119', '240305015957362773', '240304230631144023', '240304223658517271', '240304215542204003', '240304214903189810', '240304210420106566', '240304204842969700', '240304204546810518', '240304184918785542', '240304174405014153', '240304171840137322', '240304171122957423', '240304161513160468', '240304161015267139', '240304152009396138', '240304140739804437', '240304130432202218', '240304123852663346', '240304121953105732', '240304115438154108', '240304113748774140', '240304112425474587', '240304112210844649', '240304112113426401', '240304104728159861', '240304104117545040', '240304085146357037', '240304084640412103', '240304082714653061', '240304075751642235', '240304064103202206', '240304060006514308', '240304025153721816', '240304023652790188', '240304015734380582', '240304010328738168', '240303134834714277', '240303114641191119', '240303095321564064', '240303093704565269', '240303064426726866', '240303031353389087', '240303011505659252', '240303004915189311', '240302210947931062', '240302174048817826', '240302165853826802', '240302123612018386', '240302102704884057', '240302101247968519', '240302093735757247', '240302050842108170', '240302031858466031', '240302003921229923', '240301184808671777', '240301174817102223', '240301170723772922', '240301155448851917', '240301152445842871', '240301113846555755', '240301080216308897', '240301065803446520', '240229220412307379', '240229175708991105', '240229171147781410', '240229151827496373', '240226215031204366', '240226170453141019', '240225232542451539', '240224155217967439', '240221050431222066', '240219194413269963', '240219003131979490', '240218090825663519', '240216095956142757', '240203203126256620', '240130165943095217', '240109225021232727', '240108044942155235', '240305020451140311', '240304120955070547', '240304092029811997', '240304074344369598', '240301035641612164', '240229034149181227', '240223140222124799', '240303213457909889', '240303154918711090', '240301192018601447', '240301095012853298', '240304073917809096', '240304021938274201', '240305105417662589', '240305104812210379', '240305103829221255', '240305103825049854', '240305103701143791', '240305103204853250', '240305102253696045', '240305094317860658', '240305100834661986', '240305100433554412', '240219000620029104', '240213161045233814', '240305100024908496', '240305095935297521', '240305095546460784', '240305092124925703', '240305094536152181', '240305094342310806', '240203160450709708', '240305093511921756', '240305093011492374', '240305092951444402', '240221215951691732', '240305092059032242', '240305092201441560', '240305091736729371', '240305084654819840', '240305091552073502', '240305091117771725', '240305090933817294', '240305090413597296', '240305084815140773', '240305083929251255', '240305084103993827', '240305083407261562', '240305083518640105', '240305083322750208', '240305015529941184', '240302015453071831', '240305071403153743', '240225090917653718', '240226113015913417', '240305083115089661', '240305082908253464', '240305082922653706', '240305082640739489', '240305075339310882', '240305075339509738', '240305082449503333', '240305082402814455', '240305082158995989', '240305074614240351', '240216140316538358', '240219134146936087', '240305081846032109', '240303000310535567', '240303035447692167', '240226130831265598', '240305073232335691', '240301172537987595', '240204042946747177', '240229055131654575', '240125211028254100', '240223134740974033', '240305074949991719', '240305071151762969', '240224223108725298', '240305073418695340', '240305073358302572', '240225050451978671', '240305073113436033', '240305072254916998', '240305071744684592', '240305072015440021', '240305071937007395', '240305072047626689', '240305071555566890', '240305071452237567', '240305070522758880', '240305070427762415', '240305063257567097', '240305070002422220', '240305065256854669', '240305064932999532', '240305065222542087', '240305065208228362', '240305064603208991', '240305001921472507', '240304190015139605', '240304154201318098', '240304083544602679', '240302033639086749', '240305062723810050', '240305061604411763', '240301091746539195', '240305053854685282', '240305050841889605', '240305050348651816', '240305041817705164', '240305043747341667', '240305043537587286', '240305042852955964', '240305042224432404', '240305041750636017', '240305041400281446', '240305040620907188', '240305040731641469', '240305040223060908', '240305040426504394', '240305035914229659', '240305040051800851', '240305035052184605', '240305034523124163', '240305032925061576', '240305032910895943', '240305033537989590', '240305032912069998', '240305025804056064', '240305024218260598', '240305024121327989', '240305022949882749', '240305015146928222', '240305022322672996', '240305020851074193', '240305013726302542', '231229171239323196', '240305014941748813', '240304141905087058', '240304080345205490', '240305001644433582', '240303210124228965', '240304220844521260', '240302011450807145', '240222170906719348', '240304175214132807', '240301163225270993', '240305012058670663', '240305011328816196', '240221054236764397', '240305005842073318', '240305005007006940', '240304234742266830', '240305002355456803', '240305001952195780', '240305001410323191', '240305001442192623', '240305000604931556', '240217124822897629', '240216163122604154', '240215182838264842', '240214201846318917', '240214102620080773', '240211052028249538', '240209141011566753', '240209135229856087', '240209102054761239', '240209095411508907', '240208180812757743', '240208171807181337', '240208133336545305', '240207234240780820', '240207213728391592', '240207200108315769', '240207194920172466', '240207135016731528', '240207144941493561', '240207141442198193', '240207134510094841', '240207110826595576', '240207092320628604', '240207092259503704', '240205101924342516', '240116214110853146', '231207205658696591', '231207122303496866', '231207120901617297', '231207113738731394', '231207113451173731', '231205183827946263', '231205180211121546', '231205150546859996', '231205134253826328', '231205134216550125', '231205110217226573', '231205093434032906', '231205081323956875', '231204223457344587', '231204153959076460', '231201185203314993', '231201162820054827', '231201135322217786', '231128213305786206', '231128143354439225', '231127110909010085', '231127101942059821', '231127100853142221', '231126171540087588', '231126101258601106', '231126100949650365', '231126023512473980', '231125150212779359', '231125142422234179', '231125115209985094', '231124222851339696', '231124201733093726', '231124084829893217', '231124081726887290', '231124014330153604', '231119225107887937', '231119000538981510', '231118180200291352', '231107131139764328', '231102061633656567', '231029113851231236', '231029091614315373', '231025205201602340', '231023201637759761', '240216043320665305', '240214094757231814', '240213024138059766', '240210144225646641', '240208015011949087', '240207234652930736', '240127065900750458', '231205094614929250', '231205093748010742', '231205060347790096', '231205060231341545', '231128042430615903', '240215155540532818', '240215114351259254', '240213170937745740', '240211010952920833', '240209095701104047', '240208101215035257', '240208053732026491', '231207092818944146', '231205162929622412', '231205135147720324', '231205133647554809', '231205124654734434', '231205121210264990', '231205105728645637', '231205103114758929', '231205103114905272', '231205092452531052', '231205083559294355', '231205054631993037', '231201122657737367', '231130110654795637', '231129035509159848', '231126094516496149', '231126083705868954', '231125090544698679', '231102191350662990', '240304235825945527', '240223073904394375', '240217110110754102', '240217062330841185', '240216114338900462', '240216092630412674', '240216091212412371', '240216080917508504', '240216060113076048', '240216055956628793', '240216035541305206', '240216032252050107', '240216025440885442', '240216002359382555', '240215194626821643', '240215190524750044', '240215141739655251', '240215132428550794', '240215122659806978', '240215111246830841', '240215040016876940', '240214195015613833', '240214160512697722', '240214144224326494', '240214134243960387', '240214130306780561', '240214112206608312', '240214054852089246', '240214041706414328', '240214041700876453', '240213225455335160', '240213194702305526', '240213183703828746', '240213150220170285', '240213095525019981', '240213061100444299', '240213051539970549', '240212231817335371', '240212172714731765', '240212140750380690', '240212104716903858', '240212101002807056', '240212083439228847', '240212000931587746', '240211095238256824', '240211090341882801', '240211083409921455', '240211024937405454', '240210221343658849', '240210154705151816', '240210145937083480', '240210125745820408', '240210122554313938', '240210100116355583', '240210095228572625', '240210032544712325', '240210031600927933', '240210024446022691', '240210024114297774', '240210015013750896', '240209223534488771', '240209180547775553', '240209171814109455', '240209165718739689', '240209161129442549', '240209151618487717', '240209151158824131', '240209140256919912', '240209133852641845', '240209131626009641', '240209103119100095', '240209094240505257', '240209054526404275', '240209025734546649', '240209024056207945', '240209024149643994', '240209021335913321', '240209014913226494', '240209012135732559', '240208232721688726', '240208230108366316', '240208223717198928', '240208193024985523', '240208192240452004', '240208184229832361', '240208174912388935', '240208164915718035', '240208163934321035', '240208151358939723', '240208142301645829', '240208140753568683', '240208124452303665', '240208095235396261', '240208093816490527', '240208085811273743', '240208083908171630', '240208083307356376', '240208070456241367', '240208064800310954', '240208063037363477', '240208054723741737', '240208032410276058', '240207234305718196', '240207144312151962', '240207131419693814', '240207114513176757', '240207102518456965', '240206163654725545', '240206152239156356', '240206141301493121', '240205220855150129', '240205183541185743', '240201203333354288', '240128235821213093', '231212162714319206', '231209020959627215', '231209021033096591', '231208234419903550', '231208224727443857', '231208193252326971', '231208180453575748', '231208173024202935', '231208171038202814', '231208164938590831', '231208160725521258', '231208153257822445', '231208132952282159', '231208114340040125', '231208111654951301', '231208060433161067', '231208033244867467', '231208014031914926', '231208005453035181', '231208005426649437', '231208005210833458', '231208003146304994', '231208000909327882', '231207233551662387', '231207191547336774', '231207205553363164', '231207205548231779', '231207204123100126', '231207195104578815', '231207194325516107', '231207194509769939', '231207191124210731', '231207183814615099', '231207183700055606', '231207183433113250', '231207183111566146', '231207180335963583', '231207180024912342', '231207174551115167', '231207124033643790', '231207120222201679', '231207113936620940', '231205183458513943', '231205183023534439', '231205181423220808', '231205162439679058', '231205150739428697', '231205150058033290', '231205144033389400', '231205143242381509', '231205140727880298', '231205140028233333', '231205134155590147', '231205131943705179', '231205122238070404', '231205102518999467', '231205100143474707', '231205100320542975', '231205072443765567', '231205062418012958', '231205060914863013', '231205033910571078', '231205004428537678', '231204231331167668', '231204212934794633', '231204184240136837', '231204174745838249', '231202032459099483', '231202025157865242', '231202012013884142', '231202010833959035', '231202004646320551', '231202002843896014', '231201224810556907', '231201224143921551', '231201211814695045', '231201204407370489', '231201201554112161', '231201201021175166', '231201194121901749', '231201193337979472', '231201194019360004', '231201185416685635', '231201145715043134', '231201112344531812', '231201112107091828', '231130213841219016', '231130094709470774', '231129204739988163', '231129080149184390', '231129065931122821', '231129063854278135', '231128215034632038', '231128202141409747', '231128201741092431', '231128201358334896', '231128183141973789', '231128162745273923', '231128090238542927', '231128081654238738', '231128075411221118', '231128060819235495', '231128055949309091', '231128045451751397', '231128033950683554', '231128025217594371', '231128022004619531', '231128021038329860', '231127111304918601', '231127111237361090', '231127085731820290', '231127082002844451', '231127075934877779', '231127071506183033', '231127053728338818', '231127050212763554', '231127041236942920', '231127015918945471', '231127011939794792', '231126212649051889', '231126210953167981', '231126175552634782', '231126171857216537', '231126142805540725', '231126124033088917', '231126122530688704', '231125230614360355', '231125194628134135', '231125190243648202', '231125144033726153', '231125105655048354', '231125082147844522', '231125020750450754', '231124210118677831', '231124195925835258', '231124184813943261', '231124093232135739', '231124054213384892', '231124044701455998', '231123215437143865', '231119215734075139', '231119213442778297', '231119201129878876', '231119121912934939', '231119035911486416', '231117230024353232', '231117182648690582', '231117181142263022', '231117154701611481', '231117091923603109', '231115061258810653', '231113191530105932', '231113173131680870', '231113114640613601', '231112172321777403', '231110185526418727', '231107204036953650', '231107182208792462', '231102192414180169', '231102180844791360', '231102174209915316', '231031111635783432', '231029213956223056', '231029211038590252', '231029183033976821', '231029165702470183', '231029093328323451', '231029085347713209', '231029065348689103', '231028230837745368', '231028091419057882', '231027154456695070', '231027102717128114', '231026153923641278', '230930134121833388', '231212230535463600', '231208032145270501', '240304234848990069', '240304074751381212', '240304070513671383', '240304063118578618', '240304032544723972', '240304032348343606', '240304032330125516', '240304025345718417', '240304000735733253', '240303233128908034', '240303232321500920', '240303220525566641', '240303212838381196', '240303203733521789', '240303181200027107', '240303161122152969', '240303160517029810', '240303153108688346', '240303152857128924', '240303144302122701', '240303143529996622', '240303122852192500', '240303111826280560', '240303093201931093', '240303085021884547', '240303061618074100', '240303053124865519', '240303053238005891', '240303052921115445', '240303035521022325', '240303035004680053', '240303015053310078', '240303000128789434', '240302234547694732', '240302225819004112', '240302214719944611', '240302202143718235', '240302201850039943', '240302194117359808', '240302191502503844', '240302183806028853', '240302183718352080', '240302165244361418', '240302163536350368', '240302163110522294', '240302161554145348', '240302152950654355', '240302150622734200', '240302133121131192', '240302130430745532', '240302121044905599', '240302091604603655', '240302062241078744', '240302030704687202', '240302024615230397', '240302024049655081', '240302000437043604', '240301224416457035', '240301211642705368', '240301205548608001', '240301201603640949', '240301200307799306', '240301184640329541', '240301173419828785', '240301151758661029', '240301142328427633', '240207190350159369', '240301195343605183', '240301190804442931', '240301185543368904', '240301183915996516', '240301172600798656', '240301164811609050', '240301164345171306', '240301163610716060', '240301162509737696', '240301153646530572', '240301145424526910', '240301141546801263', '240301135410060840', '240301124921503649', '240301123341303275', '240304233034291184', '240304230606739012', '240304223114109194', '240223182008258088', '240304222705946755', '240304222239809545', '240304221554353476', '240304060758757992', '240304214711230011', '240304214208572974', '240304213828290489', '240224164409405629', '240304204652139846', '231225163743085194', '240304210624002252', '240131231459010530', '240304210015633159', '240304205927331905', '240304204624823508', '240304204341919085', '240304202823798719', '240304202540951566', '240304202343991746', '240304201348356780', '240304201049777741', '240304193424339552', '240304195904662364', '240304195116005112', '240304194547053175', '240304194558716049', '240304193832712716', '240304192757066676', '240304185145118497', '240304192656416708', '240304184147825078', '240304191245036262', '240304190652236694', '240304190446257355', '240304183103867420', '240304185553862623', '240304183524282476', '240304183832102946', '240304182915013075', '240304174839854386', '240304181800741699', '240304180519253883', '240304180046310009', '240304174757682794', '240304174101028339', '240304173520396428', '240304172150238382', '240304162623968145', '240303191142526021', '240304161852872774', '240302183841304105', '240304163922783304', '240304160452307799', '240304163414835458', '240304162205003568', '240304153002983950', '240304161141186044']

test_text = [240305215425930359,240305190952671347,240305200253913558,240305194642549569,240305192831820853,240305192106203905,240305172323533106,240305163749926301,240305163057711715,240305161955044170,240305153750630482,240305150441663137,240305142127301846,240305141508196057,240305133535303297,240305132446545590,240305125015402369,240305123211375329,240305115916029307,240305114553590706,240305110234923413,240305100834661986,240305100433554412,240305094317860658,240305094342310806,240305092951444402,240305091552073502,240305083929251255,240305083115089661,240305082449503333,240305074949991719,240305071937007395,240305061604411763,240305001442192623,240304223114109194,240304214305211476,240304222239809545,240304211206099241,240304211102047462,240304203446878025,240304203401857311,240304202823798719,240304202540951566,240304195857498842,240304195342644104,240304195116005112,240304194547053175,240304194558716049,240304194018413597,240304193424339552,240304192656416708,240304183524282476,240304182915013075,240304181628745974,240304180046310009,240304174607864274,240304174000849371,240304173520396428,240304173520643811,240304172911678485,240304171427220576,240303191142526021,240304163414835458,240304162909123535,240304160900573543,240304155159789078,240304152133639489,240304151343483277,240304145809629543,240304142300114546,240304135619894612,240304132650033738,240304132329515165,240304121925360946,240304114240828573,240304112142154750,240304111059651477,240304092647458915,240303213457909889,240303201911215837,240303154918711090,240303152843734078,240302162144858449,240302144551247386,240302141252938681,240301221922581217,240301192018601447,240301174021467744,240301172537987595,240301095012853298,240228202310077983,240227201727687054,240227175947560999,240223134740974033,240217124822897629,240217103153387028,240216214235443458,240216193558920827,240216164512014045,240216163122604154,240216144713241742,240216150656888490,240216144151114139,240216121026688951,240216115254475198,240215182838264842,240214210759072519,240214201846318917,240214173217457870,240214143911820662,240214131433268701,240214113145038257,240214102620080773,240213192118681644,240213144659102221,240213132033171775,240212173341085831,240211222359086819,240211202831000533,240211201619756240,240211173343685948,240211171306202321,240211162824159904,240211140238274870,240211130619431371,240211113342770387,240211052028249538,240211000644488837,240210215403888112,240210201936354046,240210182541195394,240210151120633180,240209141011566753,240209135229856087,240209114909159109,240209102054761239,240209095411508907,240208180249750150,240208180538024373,240208180812757743,240208171807181337,240208145141350595,240208133336545305,240208122710257455,240208104018666643,240208085859527790,240207234240780820,240207213728391592,240207210807904960,240207200108315769,240207194920172466,240207181004639684,240207180128512370,240207135016731528,240207144941493561,240207141442198193,240207134510094841,240207110826595576,240207092320628604,240207092259503704,240206120943222897,240205124816085558,240205101924342516,240204103339529630,240116214110853146,231225163743085194,231212230535463600,231211213857416181,231208143539488357,231208032145270501,231208002717699427,231207205658696591,231207180408371864,231207122303496866,231207120901617297,231207113738731394,231207113451173731,231206044053404817,231206025154060010,231205221453067455,231205201628900598,231205183827946263,231205180211121546,231205150546859996,231205142313085579,231205134253826328,231205134216550125,231205110217226573,231205093434032906,231205081323956875,231204223457344587,231204153959076460,231203190038756281,231203174042802160,231203132512974376,231201185203314993,231201162820054827,231201135322217786,231128213305786206,231128134809513972,231128160251063454,231128143354439225,231127222902173034,231127221610823299,231127220439770922,231127211226675139,231127195632277251,231127193752005209,231127183327447665,231127110909010085,231127101942059821,231127100853142221,231126171540087588,231126101258601106,231126100949650365,231126023512473980,231125150212779359,231125142422234179,231125115209985094,231124222851339696,231124201733093726,231124084829893217,231124081726887290,231124014330153604,231122103223266678,231122095409984769,231122093932022195,231122072701213848,231121193748591603,231121121347638278,231120194606439609,231120160929855309,231120151302661241,231120032617425151,231120022341722703,231119225107887937,231119000538981510,231118180200291352,231107131139764328,231102061633656567,231029113851231236,231029091614315373,231025205201602340,231023201637759761]


#测试有，线上环境没有
tmp_list=[]
for i in test_text:
    if str(i) not in [str(x) for x in pro_text]:
        # print(i)
        tmp_list.append(i)
print(tmp_list)
print(len(tmp_list))


# # #线上有，测试环境没有
# tmp_list=[]
# for i in pro_text:
#     if str(i) not in [str(x) for x in test_text]:
#         # print(i)
#         tmp_list.append(i)
# print(tmp_list)
# print(len(tmp_list))